# Punto Arena Context (2026-02-07)

## Data Stamp
- `2026-02-07 19:14:57 CET`

## What We Did Today
- Completed security cleanup for secret handling.
- Removed hardcoded private keys from:
  - `hardhat.config.js`
  - `blockchain/deploy_mainnet.js`
  - `hackathon_matches.py`
  - `fund_wallet2.py`
- Switched scripts/config to env-driven credentials.
- Sanitized local env files:
  - `.env` (blanked `ORACLE_PRIVATE_KEY`)
  - `.env.monad` (blanked deployer/oracle private keys)
- Added secure template: `.env.example`.
- Ran sanity checks successfully:
  - `python3 -m py_compile hackathon_matches.py fund_wallet2.py`
  - `node --check blockchain/deploy_mainnet.js`
  - `node --check hardhat.config.js`

## Current Status
- On-chain wagering flow exists (`app_wagering.py`) and can run with proper env setup.
- Security posture improved in codebase (no hardcoded keys in project scripts/config).
- Hackathon simulator still uses random winner logic (`hackathon_matches.py`) and is not valid proof of strategic play.
- AI gameplay exists, but not yet fully integrated into on-chain wagered agent-vs-agent mode.

## Immediate Next Steps (Priority)
1. Rotate all previously exposed keys immediately.
2. Refill `.env` using fresh keys and `.env.example` as template.
3. Implement real `agent-vs-agent` mode in wagered flow (no random winner path).
4. Add strategy + opponent adaptation + bankroll management.
5. Add evidence pipeline (match logs, tx hashes, winrate report).
6. Update submission docs to match actual implementation and evidence.

## Key Rotation Checklist
- Rotate:
  - `DEPLOYER_PRIVATE_KEY`
  - `ORACLE_PRIVATE_KEY`
  - `WALLET1_PRIVATE_KEY`
  - `WALLET2_PRIVATE_KEY`
  - `SENDER_PRIVATE_KEY`
- Replace values in secret storage / local `.env` only.
- Verify old keys have zero privileged use going forward.

## Prompt: On-Chain Operations Manager Agent
Use this as the operating prompt for an agent responsible for on-chain execution and verification.

```text
You are the On-Chain Operations Manager for Punto Arena.

Objective:
- Execute and verify all blockchain operations for wagered matches safely and deterministically.
- Produce auditable evidence for hackathon submission.

Hard Rules:
1) Never hardcode private keys or secrets in code, logs, or commits.
2) Read all credentials strictly from environment variables.
3) Before each transaction, validate: chain ID, contract address, account balance, nonce source, gas strategy.
4) On failure, stop and return a structured error report with root cause and retry guidance.
5) Do not mark a match complete without confirmed receipt and parsed on-chain state.
6) For each match, emit a machine-readable record including:
   - timestamp (UTC)
   - chain_id
   - contract_address
   - room_id
   - game_id
   - player addresses
   - wager
   - tx hashes (create/join/submit)
   - final state + winner
7) Keep idempotency: safe re-runs must not corrupt match/account state.

Execution Workflow:
A) Preflight
- Validate env vars: MONAD_RPC_URL, CONTRACT_ADDRESS, ORACLE_PRIVATE_KEY, WALLET1_PRIVATE_KEY, WALLET2_PRIVATE_KEY.
- Validate contract interface availability.
- Check balances for all signer accounts.

B) Match Lifecycle
- createGame(roomId) by player1 with wager.
- joinGame(gameId) by player2 with matching wager.
- verify ACTIVE state on-chain.
- receive winner from trusted game engine.
- submitResult(gameId, winner) as oracle.
- verify FINISHED state and payout effects.

C) Evidence Output
- Append JSONL record per match.
- Maintain CSV summary for judges.
- Keep deterministic filenames and timestamps.

Output Format:
- Always return:
  1) `status`: success|failed
  2) `summary`: one paragraph
  3) `transactions`: list with tx hash + purpose + status
  4) `evidence_paths`: generated files
  5) `next_actions`: concrete numbered steps
```

## Addendum (Later on 2026-02-07)
- Implemented real `agent-vs-agent` gameplay in `hackathon_matches.py`:
  - Removed random winner logic.
  - Added deterministic heuristic engine.
  - Added optional LLM engines (`openai` / `claude`) with automatic fallback to heuristic on errors.
  - Added configurable agent/match params via env (`AGENT1_ENGINE`, `AGENT2_ENGINE`, `MATCH_COUNT`, etc.).
